---
title: "3.2 — Stackelberg Competition — Practice Problems"
author: "Solutions"
date: "ECON 326 — Spring 2023"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=F,
                      warning=F,
                      message=F)
library(tidyverse)
library(ggrepel)
library(mosaic)
```


Return to the example from lessons 2.2 and 2.3: Firm 1 and Firm 2 have a constant $MC=AC=8$. The market (inverse) demand curve is given by:

$$\begin{aligned}
P&=200-2Q\\
Q&=q_1+q_2\\
\end{aligned}$$

1. Suppose Firm 1 is the Leader and Firm 2 is the follower. Find the Stackelberg Nash Equilibrium quantity for each firm. Hint, the Cournot reaction functions you found before were:

$$\begin{aligned}
q_1^\star & = 48 - 0.5 * q_2\\
q_2^\star & = 48 - 0.5 * q_1\\
\end{aligned}$$

---

Substitute follower's reaction function into market (inverse) demand function

$$\begin{align*}
P&=200-2q_{1}-2q_2 && \text{The inverse market demand function}\\
P&=200-2q_{1}-2(48-0.5q_{1}) && \text{Plugging in Firm 2's reaction function for} q_2\\
P&=200-2q_{1}-96+1q_{1} && \text{Multiplying by }-3\\
P&=104-q_{1} && \text{Simplifying the right}\\
\end{align*}$$

- Find $MR$ for Firm 1 from market demand

$$MR_{1}=104-2q_{1}$$

$$\begin{align*}
MR&=MC && \text{Profit-max condition}\\
104-2q_{1}&=8 && \text{Plugging in}\\
104&=8+2q_{1} && \text{Adding }2q_{1} \text{ to both sides}\\
96&=2q_{1} && \text{Subtracting 20 from both sides}\\
48&=q_{1}^* && \text{Dividing both sides by 2} \\
\end{align*}$$

Firm 2 will respond:

$$\begin{align*}
q_2^*&=48-0.5q_{1}\\
q_2^*&=48-0.5(48)\\
q_2^*&=48-24\\
q_2^*&=24\\
\end{align*}$$

```{r}
library(ggtext)
br_1=function(x){48-0.5*x}
br_2=function(x){96-2*x}

br_graph<-ggplot(tibble(x=c(0,10)), aes(x=x))+
  stat_function(fun=br_1, geom="line", size=2, color="red")+
    annotate(geom = "label", x = 65, y = br_1(65) , label = "Firm 1's RF",color = "red", size = 4) +
  stat_function(fun=br_2, geom="line", size=2, color="blue")+
    annotate(geom = "label", x = 15, y = br_2(15) , label = "Firm 2's RF",color = "blue", size = 4) +
    geom_segment(x=32,xend=32,y=0,yend=32, size=1, linetype="dotted", color="blue")+
  geom_segment(x=0,xend=32,y=32,yend=32, size=1, linetype="dotted", color="red")+
  scale_x_continuous(breaks = seq(0,96,8),
                     limits = c(0,98),
                     expand=c(0,0))+
  scale_y_continuous(breaks = seq(0,96,8),
                     limits = c(0,98),
                     expand=c(0,0))+
  theme_light(base_family = "Fira Sans Condensed", base_size=20)+
  labs(x = "<span style = 'color:blue'>Firm 2's Output, q<sub>2</sub></span>",
       y = "<span style = 'color:red'>Firm 1's Output, q<sub>1</sub></span>")+
  theme(axis.title.x = element_markdown(),
        axis.title.y = element_markdown())

br_graph+geom_segment(x = 0, xend = 48, y = 48, yend = 0, size = 1, linetype = "dashed")+
    geom_point(x=32,y=32,size=5,color="purple")+
  annotate(geom = "label", x = 35, y = 35 , label = "Cournot-Nash Equilibrium",color = "purple", size = 5)+
  geom_point(x=24,y=24,size=5,color="orange")+
  annotate(geom = "label", x = 30, y = 30 , label = "Collusion",color = "orange", size = 5)+
    geom_segment(x=24,xend=24,y=0,yend=24, size=1, linetype="dotted", color="orange")+
  geom_segment(x=0,xend=24,y=24,yend=24, size=1, linetype="dotted", color="orange")+
    geom_segment(x=24,xend=24,y=0,yend=48, size=1, linetype="dotted", color="darkgreen")+
  geom_segment(x=0,xend=24,y=48,yend=48, size=1, linetype="dotted", color="darkgreen")+
  geom_point(x=24,y=48,size=5,color="darkgreen")+
  annotate(geom = "label", x = 30, y = 55 , label = "Stackelberg (Firm 1 Leads)",color = "darkgreen", size = 5)


```

---

2. Find the market price.

---

With $q^*_{1}=48$ and $q^*_2=24$, this sets a market price of

$$\begin{align*}
P&=200-2Q\\
P&=200-2(72)\\
P&=56\\
\end{align*}$$

---

3. Find the profit for each firm. Compare their profits under Stackelberg competition to their profits under Cournot competition (from lesson 2.2). 

---

Profit for Firm 1 is 

$$\begin{align*}
\pi_{1}&=q_{1}(P-c)\\
\pi_{1}&=48(56-8)\\
\pi_{1}&=\$2,304\\
\end{align*}$$

Profit for Firm 2 is 

$$\begin{align*}
\pi_{2}&=q_{2}(P-c)\\
\pi_{2}&=24(56-8)\\
\pi_{2}&=\$1,152\\
\end{align*}$$

```{r}
Demand_market = function(x){200-2*x}
MR_market = function(x){200-4*x}
MC_market = function(x){8}

points <- tribble(
  ~x, ~y, ~color, ~lab,
  64, 72, "purple", "Cournot eq.",
  48, 104, "orange", "Collusion",
  96, 8, "green", "Bertrand/P.C. eq.",
  72, 56, "darkgreen", "Stackelberg eq."
  )

ggplot(tibble(x=c(0,10)), aes(x=x))+
  #geom_polygon(data=CS_cheat, aes(x=x,y=y), fill="blue",alpha=0.5)+ #cs
  #geom_rect(xmin=0, xmax=56.25, ymin=0.5, ymax=2.18, fill="green", alpha=0.5)+ # pi
  #geom_polygon(data=DWL_cheat, aes(x=x,y=y), fill="black",alpha=0.5)+ #dwl
  stat_function(fun=Demand_market, geom="line", size=2, color="blue")+
    stat_function(fun=MR_market, geom="line", size=2, color="purple")+
  annotate(geom = "label", x = 20, y = Demand_market(20) , label = "Market Demand",color = "blue", size = 4) +
    annotate(geom = "label", x = 20, y = MR_market(20) , label = "MR(q)",color = "purple", size = 4) +
  
      stat_function(fun=MC_market, geom="line", size=2, color="red")+
  annotate(geom = "label", x = 20, y = MC_market(20) , label = "MC(q)=AC(q)",color = "red", size = 4) +

  geom_segment(x=64,xend=64,y=0,yend=72,linetype="dotted", size =1)+
  geom_segment(x=0,xend=64,y=72,yend=72,linetype="dotted", size =1)+

  geom_segment(x=48,xend=48,y=0,yend=104,linetype="dotted", size =1)+
  geom_segment(x=0,xend=48,y=104,yend=104,linetype="dotted", size =1)+
  geom_segment(x=96,xend=96,y=0,yend=8,linetype="dotted", size =1)+
  
    geom_segment(x=0,xend=72,y=56,yend=56,linetype="dotted", size =1)+
  geom_segment(x=72,xend=72,y=0,yend=56,linetype="dotted", size =1)+

  geom_point(data = points, aes(x = x, y = y, color = color), size = 3)+
  geom_text_repel(data = points, aes(x = x, y = y, label = lab, color = color), size = 4, box.padding = 0.5, nudge_y = 0.5)+
  guides(color = FALSE)+
  scale_color_manual(values = c("purple"= "purple", "orange" = "orange", "green" = "green", "darkgreen" = "darkgreen"))+
  scale_x_continuous(breaks = seq(0,100,10),
                     limits = c(0,100),
                     expand=c(0,0))+
  scale_y_continuous(breaks = seq(0,200,20),
                     labels = scales::dollar,
                     limits = c(0,200),
                     expand=c(0,0))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)+
  labs(x = "Industry Output, Q",
       y = "Market Price, p",
       title = "Industry")
```

Compared to the Cournot equilibrium where each firm produces 32, setting a market price of $72, and a profit of $2048 for each firm, under Stackelberg competition, Firm 1 produces more than Cournot and earns higher than Cournot profits, while Firm 2 produces less than Cournot and earns less profit.